## Прокси-граббер сервис курсов валют, криптовалют, котировок

Сервис по расписанию опрашивает удаленные сервисы курсов валют, сохраняет результат в БД и
реализует http api для запроса курсов валют с нужных площадок.

### Запуск и настройка
Точкой входа в приложение является `./bin/www.\`
Скрипты для запуска есть в разделе `scripts` файла `package.json`
Смотрите настроки в `./config/<env>.app.config.js`, где `env` - значение переменной среды окружения.
* `port` - порт http сервера
* `mysql` - парметры соединения с БД.

В `./config/sources` содержаться json файлы с параметрами внешних сервисов с которых запрашивают данных о курсах.
Обязательных параметров два
* `handlers` - файл обработчик для данной службы
* `time` - время в секундах - частота с которой будет запускаться обрабочтик указанных в handlers
  Остальные параметры, если они есть, будут переданы в handler

Файл указный в handler реализует модуль - функцию которая запрашивает внешний сервис,
и возвращает полученные данные в виде массива объектов с полями:
* `from` - валюта
* `to` -валюта
* `rate` - курс между from и to
* `lastupdate` - timestamp сделки
  Данные сохраняются в базе данных с привязкой к источнику данных. Название источника формируется из
  названия конфируционного файла (минус расширение .json)

Полученный объект сохраняется в базу данных.

### Подключение нового источника данных
Для этого нужно:
1. в `./config/sources` разметить json файл с парметрами (описаны ваше)
2. реализовать обработчик, указаный в json конфигурационном файле, разметить его в `./lib/handlers`

### Запрос курсов
Доступен по адресу
`<адрес сервера>/api/rates?from=BTC,LINK&to=USD,EUR&provider=cryptocompare.com\`
где:
* from - перечень валют. Если валют несколько, то указываются через запятую
* to - перечень валют. Если валют несколько, то указываются через запятую
* provider - источник курсов валют. Название правайдера источника данных.
  При запросе, сервис запрашивает курсы с указанного провайдера (используется handler указанный в конфигурационном файле провайдера).
  Если источник не доступен, сервер вернут последние из имеющихся курсов валют в базе данных.